<% provide(:title, current_site.sitename + " " + @sport.name + " - Edit Photo") %>
<p>
<div class="row">
	<div class="col-xs-8">
		<%= image_tag @photo.large_url %>
  </div>
</div>
<p>
<script>
  $(document).ready(function() {
    $('#select_team').change(function() {
      $.ajax({
        url: "<%= updategameschedule_sport_photos_path %>",
        data: {
          teamid : $('#select_team').val()
        },
        dataType: "script"
      });
    });
  });
</script>
<div class="row">
  <div class="col-xs-11">
    <%= simple_form_for [@sport, @photo], 
							:defaults => { :input_html => { :class => "form-control" } } do |f| %>
		<%= render 'shared/error_messages', object: f.object %>
	      <div class="row">
	        <div class="col-xs-4">
				<%= f.input :teamid, collection: @teams.collect{ |t| [t.team_name, t.id] }, label: "Tag photo for team", input_html: {id: "select_team"}  %>
	        </div>
	        <div class="col-xs-4 col-xs-offset-1">
		        Current athletes tagged:&nbsp
				<% if @athlete_tags.empty? %>
					<h4>None</h4>
				<% else %>
			        <% @athlete_tags.each do |a| %>
			            <%= a.full_name %>
			        <% end %>
				<% end %>
	        </div>
	      </div>
			<br/>
		 <div class="row">
			<div class="col-xs-4">
				<%= f.input :gameschedule_id, collection: @gameschedules.collect{ |t| [t.game_name, t.id] }, label: "Tag game", 
							include_blank: true, input_html: { id: "gameschedules_select" }  %>
			</div><p>
	        <div class="col-xs-4 col-xs-offset-1">
	          Tag Athletes:&nbsp<br/>
				<!--%= f.input :athlete, collection: @athletes.collect{ |t| [t.full_name, t.id] }, label: "Tag athletes", prompt: "Tag Athlete", hint: "Tag athletes" %-->
	    		<%= collection_select(:athlete,	:id, @athletes, :id, :full_name, { prompt: "Tag Athlete" }, 
	    			{ id: "athletes_select", class: 'form-control' } ) %>
	        </div>
	    </div>
	    <% if @sport.name == "Football" %>
			 <div class="row">
			     <div class="col-xs-4">
					<h5>Play Tagging:</h5>
		   			<% if !@gamelogs.empty? %>
			    		<!--%= collection_select(:play, :id, @gamelogs, :id, :logentrytext, prompt:  "Tag Play", include_blank: true, 
			    							  input_html: { id: "gamelogs_select"} ) %-->
				    	<%= f.input :gamelog_id, collection: @gamelogs.collect{ |t| [t.logentrytext, t.id] }, label:  "Tag Play", include_blank: true,
				    			input_html: { id: "gamelogs_select" } %>
					<% else %>
						No game tagged. Tag game before tagging play!
					<% end %>
		        </div>
		     </div>
		<% end %>
	      <p>
	      <div class="row">
			<div class="col-xs-4">
				<%= f.input	:displayname,	label:	"Photo Name" %>
        	</div>
				<div class="col-xs-6 col-xs-offset-1">
					<%= f.input	:description, as: :text, label:	"Photo Description" %>
				</div>
			</div><br/>
			<div class="row">
				<div class="col-xs-1 col-xs-offset-4">
					<%= f.button :submit, 'Update', class:	"btn btn-sm btn-primary" %>
			</div>
        	<% if isAdmin? || (user_signed_in? && (current_user.id == @photo.owner)) %>
	          <div class="row">
	            <div class="col-xs-1 col-xs-offset-1">
	              <%= link_to "Delete", sport_photo_path(@sport, @photo), method: :delete, class: "btn btn-sm btn-danger", data: { confirm: "You sure?" }%>
	            </div>
	          </div>
        	<% end %>
			</div>
		<% end %>	
	</div>	
    <div class="row">
  		<div class="col-xs-11">
			Untag Athlete:
    		<%= simple_form_for @photo, url:	untagathlete_sport_photos_path(@sport), html: { method: :post}, 
							:defaults => { :input_html => { :class => "form-control" } } do |f| %>
    			<p>
          		<%= f.hidden_field :id, value: @photo.id %>
          		<div class="row">
          			<div class="col-xs-4">
    					<%= collection_select(:athlete,	:name,	@athlete_tags, :id, :full_name, {}, { class: 'form-control' } ) %>
    				</div>
          			<div class="col-xs-2">
    					<%= f.button :submit, 'Untag', class:	"btn btn-sm btn-warning" %>
    				</div>
    			</div>
    		<% end %>
    	</div>
  	</div>
</div>
