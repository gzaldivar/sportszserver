<% provide(:title, current_site.sitename + " " + @sport.name + " - Soccer Stats") %>
<p>
<div class="row">
	<div class="span10">
		<% if !@athlete.nil? and !@gameschedule.nil? %>
			<% if @stats.empty? %>
				<h4>There are no stats for <%= link_to(@athlete.logname, [@sport, @athlete]) %> and 
										   <%= link_to(@gameschedule.game_name, [@sport, @team, @gameschedule]) %></h4>
				<% if isAdmin? %>
					<%= link_to "Add Stat", new_sport_athlete_soccer_path(@sport, @athlete, gameschedule_id: @gameschedule), 
							class: "btn btn-medium btn-primary" %>
				<% end %>
			<% else %>
				<h4>Stats for <%= @athlete.logname %> for game <%= @gameschedule.game_name %></h4>
				<table class="table table-bordered">
					<%= render "stat_header", name: "Game" %>
					<%= render "stat_body", stat: @stats[0], name: "Game" %>
				</table>
			<% end %>
		<% elsif !@athlete.nil? %>
			<% if @stats.empty? %>
				<h4>There are no stats for <%= link_to(@athlete.logname, [@sport, @athlete]) %></h4>
				<% if isAdmin? %>
				 	<%= link_to "Add Stats", new_sport_athlete_soccer_path(@sport, @athlete), 
							class: "btn btn-medium btn-primary" %>
				<% end %>
			<% else %>
				<h4>Stats for <%= @athlete.logname %></h4>
				<table class="table table-bordered">
					<%= render "stat_header", name: "Player" %>
					<% @gameschedules.each do |g| %>
						<% @thestat = nil %>
						<% @stats.each do |b| %>
							<% if g.id == b.gameschedule_id %>
								<% @thestat = b %>
								<% break %>
							<% end %>
						<% end %>
						<% if @thestat %>
							<%= render "stat_body", stat: @thestat, name: "Game" %>
						<% else %>
							<%= render "stat_body", stat: Soccer.new(gameschedule: g.id, athlete: @athlete.id), name: "Game" %>
						<% end %>
					<% end %>
				</table>
			<% end %>
		<% elsif !@gameschedule.nil? %>
			<% if @stats.empty? %>
				<h4>There are no stats for <%= link_to(@gameschedule.game_name, [@sport, @team, @gameschedule]) %></h4>
				<% if isAdmin? %>
					<%= link_to "Add Stats", new_sport_athlete_soccer_path(@sport, @athlete), 
							class: "btn btn-medium btn-primary" %>
				<% end %>
			<% else %>
				<h4>Stats for game <%= @gameschedule.game_name %></h4>
				<table class="table table-bordered">
					<%= render "stat_header", name: "Player" %>
					<% @athletes.each do |a| %>
						<% @thestat = nil %>
						<% @stats.each do |b| %>
							<% if a.id == b.athlete_id %>
								<% @thestat = b %>
								<% break %>
							<% end %>
						<% end %>
						<% if @thestat %>
							<%= render "stat_body", stat: b, name: "Player" %>
						<% else %>
							<%= render "stat_body", stat: Soccer.new(gameschedule: @gameschedule.id, athlete: a.id), name: "Player" %>
						<% end %>
					<% end %>
				</table>
			<% end %>
		<% end %>
	</div>
</div>